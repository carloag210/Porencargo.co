{% extends "mis_pedidos.html" %}

{% block content %}

<h1 class="page-title">Mis pedidos</h1>

{% if paquetes %}
    {% for paquete in paquetes %}
        <div class="bloque">
            <ul>
                <!-- Fecha de recibido al inicio -->
                <li><strong>Fecha de recibido:</strong>
                    {% if paquete.fecha_recibido %}
                        {{ paquete.fecha_recibido.strftime('%d/%m/%Y') }}
                    {% else %}
                        No recibido aún
                    {% endif %}
                </li>

                <li><strong>Nombre:</strong> {{ paquete.nombre }}</li>
                <li><strong>Precio:</strong> {{ paquete.precio }}</li>
                <li><strong>Número de guía:</strong> {{ paquete.numero_guia }}</li>
                <li><strong>Peso:</strong> {{ paquete.peso }}</li>
                
                {% if paquete.prealerta %}
                  <li style="color: #e90303;"><strong style="color: #333;">Aviso:</strong> En prealerta</li>
                {% endif %}
                
                <li>
                  <strong>Estado:</strong> 
                  <span style="color: {% if paquete.estado.value == 'En prealerta' %}#e90303{% else %}#50c850{% endif %};">
                    {{ paquete.estado.value }}
                  </span>
                </li>

                <!-- ✅ Checkbox de consolidación -->
                <li>
                  <form method="POST" action="{{ url_for('marcar_consolidar') }}">
                    <input type="hidden" name="paquete_id" value="{{ paquete.id }}">
                    <label>
                      <input type="checkbox" name="consolidar" value="true"
                             onchange="this.form.submit()" 
                             {% if paquete.consolidar %}checked{% endif %}>
                      ✅ Marcar para consolidación
                    </label>
                  </form>
                </li>
            </ul>
        </div>
    {% endfor %}
{% else %}
    <p>No tienes paquetes registrados.</p>
{% endif %}

{% endblock %}
